<style scoped>
.info_user_wrapper_mobile .green-button,
.back_page .green-button {
  margin: 3px 0;
  padding: 4px 0;
}

.owl-carousel {
  direction: ltr;
}

.owl-carousel img {
  border-radius: 3px;
}

.filter-mobile-sidebar .box-sidebar i {
  text-align: center;
  top: 0;
  right: 3px;
}

.filter-mobile-sidebar .box-sidebar select {
  width: calc(100% - 45px);
}

.box-sidebar select {
  border-radius: 3px;
  border: 1px solid #4c5058;
  width: 80%;
  padding: 5px 15px;
}

.profile-main-content-item {
  direction: rtl;
  float: right;
  width: 100%;
  margin: -100px auto 24px;
  border-radius: 5px;
  box-shadow: 0 0 5px #cfcfcf;
  padding: 15px;
  background: #fff;
}

.main-article-title {
  margin: 0 auto 15px;
  font-weight: bold;
}

.main-article-title a {
  color: #4c5058;
}

.main-article-title a:hover {
  color: #444;
}

.main-article-content {
  padding: 0;
  padding-right: 25px;
  padding-top: 15px;
}

.main-article-content p {
  margin-bottom: 15px;
  font-size: 15px;
  font-weight: bold;
}

.main-article-content p span {
  font-weight: normal;
}

.image-article-content {
  padding: 0;
  padding-top: 10px;
  float: right;
}

.image-article-content a:hover img {
  transition: 300ms;
}

.image-article-content img {
  transition: 300ms;
}

.main-image > div {
  display: none;
}

.main-image > div:first-of-type {
  display: block;
}

.user-contents {
  border-right: 2px solid #f0f3f6;
  text-align: right;
  padding-right: 15px;
}

.user-contents h1 {
  padding: 14px 0;
}

.title_content {
  border-bottom: 1px solid #ededed;
  padding: 0;
}

.title_content:last-of-type {
  border-bottom: none;
}

.info-section {
  color: #fff;
  background: #3a3c39;
  padding: 15px;
  font-size: 17px;
}

.info_user_wrapper_mobile .col-xs-6 {
  font-size: 10px;
}

.info_user_wrapper_mobile .info-num {
  font-size: 18px;
}

.contents-info-num {
  color: #00c569;
}

.contents-info p {
  font-size: 15px;
  padding-top: 6px;
}

.sub-header {
  background: #ededed;
  text-align: center;
  padding: 0;
}

.sub-header a:hover {
  color: #313942;
}

.sub-header a:hover::after {
  content: " ";
  position: absolute;
  bottom: 0;
  left: 0;
  background: #00c569;
  height: 3px;
  width: 100%;
}

.sub-header .active a {
  color: #313942;
}

.sub-header .active a::after {
  content: " ";
  position: absolute;
  bottom: 0;
  left: 0;
  background: #00c569;
  height: 3px;
  width: 100%;
}

.sub-header > div {
  border-top: 1px solid #ededed;
  padding: 0;
}

.sub-header > div.active {
  background: #fff;
}

.sub-header ul {
  text-align: center;
}

.sub-header a i {
  font-size: 20px;

  position: absolute;

  top: 0;

  right: -30px;

  display: inline-block;

  width: 20px;

  height: 30px;

  float: right;
}

.inside-links {
  display: inline-block;

  position: relative;
}

.sub-header i.buskool-icon {
  top: -6px;
}

.sub-header a {
  padding: 16px;
  color: #808c9b;
  font-weight: bold;
  font-size: 14px;
  position: relative;
  display: block;
}

.user-contents p {
  margin: 14px auto;
  font-size: 16px;
  font-weight: 800;
}

.user-contents p span {
  color: #767676;
  font-weight: 400;
}

.user-image {
  width: 120px;
  height: 120px;
  overflow: hidden;
  border-radius: 50%;
  margin: 0 auto 10px;
}

.user-image-content {
  width: 40px;
  height: 40px;
  overflow: hidden;
  border-radius: 50%;
  margin: 7px 5px 7px 20px;
  float: right;
}

.content_title_mobile {
  float: right;
  padding-top: 23px;
  font-size: 12px;
  font-weight: bold;
}

.zone_content_title {
  font-size: 12px;

  font-weight: lighter;

  color: #989898;

  border-right: 1px solid;

  margin: 0 5px;

  padding: 0 5px;

  height: 16px;

  display: inline-block;
}

.user-image img,
.user-image > div,
.user-image-content img,
.user-image-content > div {
  height: 100%;
}

.content_title {
  float: right;
}

.sidebar-fix {
  position: fixed;
  right: 0;
  top: 64px;
  z-index: 2;
}

.header-content {
  padding: 20px 0;
}

.image_user_wrapper {
  float: right;
  padding: 0;
}

.logo {
  padding: 10px;
  text-align: right;
  float: right;
  width: 190px;
}

.logo img {
  width: 150px;
}

.image-wrapper {
  height: 300px;
  overflow: hidden;
}

.btn {
  margin: 3px 0;
  padding: 4px 0;
}

.btn.btn-copy {
  width: 100%;
}

.content_user_wrapper_mobile {
  border-top: 1px solid #eee;
  margin-top: 10px;
}

p.response-rate {
  color: #777;
  font-size: 12px;
  margin: 7px auto 0;
  padding: 0;
}

p.response-rate span {
  color: #e41c38;
}

@media screen and (max-width: 992px) {
  .title-page {
    text-align: center;
    margin: -10px auto 95px;
  }
}

@media screen and (max-width: 767px) {
  .profile-list {
    left: 40px;
    top: 80px;
  }

  .profile-main-content-item {
    padding: 0;
    margin: 63px auto 24px;
  }

  .header-content {
    padding: 35px 15px 15px;
  }

  .content_user_wrapper_mobile {
    padding: 0;
  }

  .main-article-content {
    padding: 15px;
  }

  .ceteficate-image {
    height: 374px;
    overflow: hidden;
  }

  .image-article-content {
    width: 100%;
  }

  .cerificates,
  .ceteficate-image,
  .contents,
  .main-image,
  .article-contents {
    padding: 0;
  }

  #main .contents {
    background: #fff;
    width: 100%;
  }

  .title-content {
    margin: 7px 0 20px;
    padding: 15px;
    border-bottom: 1px solid #ededed;
  }

  .logo img {
    width: 100%;
  }

  .user-contents {
    border-right: none;
  }

  .user-contents h1 {
    float: none;

    text-align: right;

    overflow: hidden;

    font-size: 18px;
    padding: 15px 0;
  }

  .user-contents p {
    margin: 14px auto;
    font-size: 14px;
    font-weight: 800;
  }

  .content_user_info {
    text-align: right;
    margin-bottom: 10px;
    padding: 0;
  }

  .title_content {
    border-bottom: none;
  }

  .info-section {
    text-align: center;
  }

  .user-image {
    width: 85px;
    height: 85px;
    overflow: hidden;
    border-radius: 50%;
    margin: 0 auto 10px;
  }

  .back_page {
    display: none;
  }

  .main-content,
  #main {
    padding: 0;
  }

  .ceteficate-image {
    height: 250px;
    overflow: hidden;
  }
}

@media screen and (max-width: 715px) {
  .name-header-profile {
    display: none;
  }

  .ceteficate-image {
    height: 200px;
    overflow: hidden;
  }

  .profile-menu-header i {
    position: absolute;
    left: -75px;
    top: 22px;
    font-size: 20px;
  }
}

@media screen and (max-width: 555px) {
  .logo {
    padding: 20px 0;
  }
}

@media screen and (max-width: 345px) {
}

.profile-header {
  color: #fff;
  background-size: cover;
  overflow: hidden;
  padding: 140px 0 65px;
}

.main-content-index-pages h1,
.main-content-index-pages h2,
.main-content-index-pages h3,
.main-content-index-pages h4,
.main-content-index-pages h5 {
  margin: 15px 0;
}

#wrap-footer {
  display: none;
}

.title_content .back_page.first-back {
  margin-top: 9px;
}

.profile-main-content-item {
  box-shadow: none;
}

.valid-seller {
  font-size: 14px;

  color: #00c569;

  border: 2px solid;

  border-radius: 3px;

  padding: 4px 8px 3px;

  position: relative;
  display: inline-block;
  top: -3px;
}

.description {
  padding: 0 15px;
  text-align: right;
  white-space: pre-wrap;
  line-height: 1.618;
}

@media screen and (max-width: 767px) {
  .valid-seller {
    font-size: 12px;
  }

  .user-contents {
    padding: 0 15px;
  }

  .user-contents .user-image,
  .user-contents p {
    float: right;
  }

  .user-contents p {
    padding: 15px;
    margin: 0;
    font-size: 14px;
    font-weight: 800;
  }

  .user-contents p:first-of-type {
    padding-right: 0;
  }

  .user-contents .green-button {
    float: left;
    width: initial;
    padding: 15px;
  }

  .contents > .row {
    margin: 0;
  }

  p.response-rate {
    color: #777;
    font-size: 12px;
    margin: 7px auto 0;
    padding: 0;
    width: 100%;
  }

  p.response-rate span {
    color: #e41c38;
  }
}

@media screen and (max-width: 500px) {
  .user-contents .user-image {
    width: 50px;
    height: 50px;
  }

  .user-contents p {
    padding: 5px 0;
    width: 100%;
  }

  .user-contents .green-button {
    width: initial;
  }

  .content_title span:first-of-type {
    padding-bottom: 20px;

    display: inline-block;
  }
}

.green-button {
  margin: 15px 0 0;
  display: inline-block;
  background: #00c569;
  color: #fff;
  padding: 10px 35px;
  width: 100%;
  border-radius: 3px;
  text-align: center;
  font-size: 13px;
  font-weight: bold;
  line-height: 21px;
  border: none;
}
.green-button.review-button {
  display: inline;

  margin: 0;

  padding: 3px 30px;

  width: initial;

  position: relative;

  top: -5px;

  float: none;
}

.review-button i {
  color: #ffbb00;
}
</style>

<template>
  <div>
    <script v-html="jsonLDObject" type="application/ld+json"></script>

    <header class="hidden-xs profile-header main-header">
      <div class="title-page col-xs-12">پروفایل</div>
    </header>

    <main id="main" class="container">
      <section
        class="main-content"
        itemscope
        itemprop="Person"
        itemtype="http://schema.org/Person"
      >
        <div class="profile-main-content-item">
          <div class="header-content col-xs-12">
            <div class="image_user_wrapper col-xs-4 col-sm-3 col-md-2">
              <div v-if="profileOwner.user_info" class="user-image">
                <div v-if="profileOwner.profile.profile_photo">
                  <img
                    v-bind:src="str + '/' + profileOwner.profile.profile_photo"
                    :alt="
                      profileOwner.user_info.first_name +
                      ' ' +
                      profileOwner.user_info.last_name
                    "
                  />
                </div>

                <div v-else>
                  <img
                    :src="defultimg"
                    class="image_defult"
                    :alt="
                      profileOwner.user_info.first_name +
                      ' ' +
                      profileOwner.user_info.last_name
                    "
                  />
                </div>
              </div>

              <div v-else class="user-image">
                <div
                  class="placeholder-content default-wrapper-main-image"
                ></div>
              </div>
            </div>

            <div
              class="info_user_wrapper_mobile hidden-sm hidden-md hidden-lg col-xs-8 col-sm-4"
            >
              <div class="row">
                <div
                  class="col-xs-6 text-center"
                  v-if="profileOwnerStatistics.reputation_score"
                >
                  <div
                    class="info-num"
                    v-text="profileOwnerStatistics.reputation_score"
                  ></div>
                  اعتبار
                </div>
                <div class="col-xs-6 text-center" v-else>
                  <div
                    class="info-num placeholder-content content-min-width margin-auto"
                  ></div>
                </div>

                <div
                  class="col-xs-6 text-center"
                  v-if="
                    profileOwner.user_info.is_seller && profileOwnerStatistics
                  "
                >
                  <div
                    class="info-num"
                    v-text="profileOwnerStatistics.product_count"
                  ></div>
                  محصولات
                </div>

                <div
                  class="col-xs-6 text-center"
                  v-else-if="
                    profileOwner.user_info.is_buyer && profileOwnerStatistics
                  "
                >
                  <div
                    class="info-num"
                    v-text="profileOwnerStatistics.buyAd_count"
                  ></div>
                  درخواست ها
                </div>

                <div class="col-xs-6 text-center" v-else>
                  <div
                    class="info-num placeholder-content content-min-width margin-auto"
                  ></div>
                </div>

                <div class="col-xs-12">
                  <div v-if="!profileOwner.user_info.id">
                    <div
                      class="default-boxing-size placeholder-content content-full-width"
                    ></div>
                  </div>

                  <div v-else>
                    <div
                      v-if="
                        currentUser.user_info &&
                        currentUser.user_info.id === profileOwner.user_info.id
                      "
                    >
                      <router-link
                        :to="{ name: 'profileBasicSeller' }"
                        class="green-button edit"
                        v-if="currentUser.user_info.is_seller == 1"
                      >
                        <i class="fa fa-pencil-alt"></i>
                        ویرایش پروفایل
                      </router-link>

                      <router-link
                        :to="{ name: 'profileBasicBuyer' }"
                        class="green-button edit"
                        v-else-if="currentUser.user_info.is_seller == 0"
                      >
                        <i class="fa fa-pencil-alt"></i>
                        ویرایش پروفایل
                      </router-link>
                    </div>

                    <a
                      v-else
                      href="#"
                      @click.prevent="openChat()"
                      class="green-button edit"
                    >
                      <i class="fa fa-envelope"></i>
                      ارسال پیام
                    </a>
                  </div>

                  <div v-if="!profileOwner.user_info.id">
                    <div
                      class="placeholder-content padding-15-0 content-full-width"
                    ></div>
                  </div>

                  <button
                    v-else
                    href="#"
                    class="btn btn-copy"
                    @click.prevent="copyProfileLinkToClipBoard"
                  >
                    <i class="fab fa-whatsapp"></i>
                    اشتراک در واتس آپ
                  </button>
                </div>
              </div>
            </div>

            <div
              class="content_user_wrapper hidden-xs col-xs-6 col-sm-9 col-md-10"
            >
              <div class="user-contents row">
                <div class="title_content col-xs-12">
                  <div class="back_page first-back col-xs-12 col-sm-4 col-md-3">
                    <a
                      href="javascript:history.back()"
                      class="green-button"
                      @click="
                        registerComponentStatistics(
                          'profileView',
                          'BackButton',
                          'click on back button'
                        )
                      "
                    >
                      بازگشت به صفحه قبل
                    </a>
                  </div>

                  <h1
                    v-if="profileOwner.user_info"
                    class="content_title col-xs-12 col-sm-8 col-md-9"
                    itemprop="name"
                  >
                    <span
                      v-text="
                        profileOwner.user_info.first_name +
                        ' ' +
                        profileOwner.user_info.last_name
                      "
                    ></span>

                    <span
                      class="valid-seller"
                      v-if="profileOwnerStatistics.validated_seller"
                    >
                      <i class="fa fa-check-circle"></i>
                      فروشنده معتبر
                    </span>
                    <!-- <button
                      type="button"
                      class="green-button review-button"
                      @click.prevent="activeReviewModal()"
                    >
                      <i class="fa fa-star"></i>
                      ارسال نظر
                    </button> -->
                    <p
                      v-if="profileOwnerStatistics.response_rate"
                      class="response-rate"
                    >
                      احتمال پاسخ گویی
                      <span
                        v-text="'%' + profileOwnerStatistics.response_rate"
                      ></span>
                    </p>
                  </h1>

                  <h1
                    v-else
                    class="h-20 placeholder-content content-half-width"
                  ></h1>
                </div>

                <div class="title_content col-xs-12">
                  <div class="back_page col-xs-12 col-sm-4 col-md-3">
                    <div v-if="!profileOwner.user_info.id">
                      <div
                        class="default-boxing-size placeholder-content content-full-width"
                      ></div>
                    </div>
                    <div v-else>
                      <div
                        v-if="
                          currentUser.user_info &&
                          currentUser.user_info.id === profileOwner.user_info.id
                        "
                      >
                        <router-link
                          :to="{ name: 'profileBasicSeller' }"
                          class="green-button edit"
                          v-if="currentUser.user_info.is_seller == 1"
                        >
                          <i class="fa fa-pencil-alt"></i>
                          ویرایش پروفایل
                        </router-link>

                        <router-link
                          :to="{ name: 'profileBasicBuyer' }"
                          class="green-button edit"
                          v-else-if="currentUser.user_info.is_seller == 0"
                        >
                          <i class="fa fa-pencil-alt"></i>
                          ویرایش پروفایل
                        </router-link>
                      </div>

                      <a
                        v-else
                        href="#"
                        @click.prevent="openChat()"
                        class="green-button edit"
                      >
                        <i class="fa fa-envelope"></i>
                        ارسال پیام
                      </a>
                    </div>

                    <div v-if="!profileOwner.user_info.id">
                      <div
                        class="default-boxing-size placeholder-content content-full-width"
                      ></div>
                    </div>
                    <button
                      v-else
                      class="btn btn-copy"
                      @click="copyProfileLinkToClipBoard"
                      :value="copyLinkText"
                    >
                      <i :class="copyLinkClass" aria-hidden="true"></i>
                      <span v-text="copyLinkText"></span>
                    </button>
                  </div>

                  <div class="content_user_info col-xs-12 col-sm-8 col-md-9">
                    <div class="row">
                      <div class="col-xs-6 pull-right">
                        <p v-if="profileOwner.activity_domain">
                          حوزه ی فعالیت :
                          <span v-text="profileOwner.activity_domain"></span>
                        </p>
                        <p v-else>
                          <span
                            class="h-20 placeholder-content content-full-width"
                          ></span>
                        </p>
                      </div>

                      <div class="col-xs-6">
                        <p v-if="profileOwner.user_info">
                          آدرس :
                          <span
                            itemprop="address"
                            v-text="
                              profileOwner.user_info.province +
                              ' - ' +
                              profileOwner.user_info.city
                            "
                          ></span>
                        </p>

                        <p v-else>
                          <span
                            class="h-20 placeholder-content content-full-width"
                          ></span>
                        </p>
                      </div>

                      <div class="col-xs-6 pull-right">
                        <p v-if="profileOwner.profile.is_company">
                          نام شرکت
                          <span
                            v-text="profileOwner.profile.company_name"
                          ></span>
                        </p>
                      </div>

                      <div class="col-xs-6">
                        <p v-if="profileOwner.profile.is_company">
                          شماره ثبت
                          <span
                            v-text="profileOwner.profile.company_register_code"
                          ></span>
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div
              class="content_user_wrapper_mobile hidden-sm hidden-md hidden-lg col-xs-12"
            >
              <div class="user-contents row">
                <div class="title_content col-xs-12">
                  <div class="back_page col-xs-12 col-sm-4">
                    <button
                      class="btn btn-copy"
                      @click="copyProfileLinkToClipBoard"
                      :value="copyLinkText"
                    >
                      <i :class="copyLinkClass" aria-hidden="true"></i>
                      <span v-text="copyLinkText"></span>
                    </button>

                    <a
                      href="#"
                      class="green-button edit"
                      @click="copyProfileLinkToClipBoard"
                    >
                      <i class="fa fa-pencil-alt"></i>
                      ویرایش پروفایل
                    </a>
                  </div>

                  <h1
                    v-if="profileOwner.user_info"
                    class="content_title col-xs-12 col-sm-8"
                  >
                    <span
                      v-text="
                        profileOwner.user_info.first_name +
                        ' ' +
                        profileOwner.user_info.last_name
                      "
                    ></span>

                    <span
                      class="valid-seller"
                      v-if="profileOwnerStatistics.validated_seller"
                    >
                      <i class="fa fa-check-circle"></i>
                      فروشنده معتبر
                    </span>
                    <!-- <button
                      type="button"
                      class="green-button review-button"
                      @click.prevent="activeReviewModal()"
                    >
                      <i class="fa fa-star"></i>
                      ارسال نظر
                    </button> -->
                    <p
                      v-if="profileOwnerStatistics.response_rate"
                      class="response-rate"
                    >
                      احتمال پاسخ گویی
                      <span
                        v-text="'%' + profileOwnerStatistics.response_rate"
                      ></span>
                    </p>
                  </h1>
                  <h1
                    v-else
                    class="placeholder-content margin-15-0 content-half-width padding-15-0"
                  ></h1>

                  <div class="content_user_info col-xs-12 col-sm-8">
                    <div class="row">
                      <div class="col-xs-6 pull-right">
                        <p v-if="profileOwner.activity_domain">
                          حوزه ی فعالیت :
                          <span v-text="profileOwner.activity_domain"></span>
                        </p>
                        <span
                          v-else
                          class="placeholder-content content-full-width"
                        ></span>
                      </div>

                      <div class="col-xs-6">
                        <p v-if="profileOwner.user_info">
                          آدرس :
                          <span
                            itemprop="address"
                            v-text="
                              profileOwner.user_info.province +
                              ' - ' +
                              profileOwner.user_info.city
                            "
                          ></span>
                        </p>
                        <span
                          v-else
                          class="placeholder-content content-full-width"
                        ></span>
                      </div>

                      <div class="col-xs-6 pull-right">
                        <p v-if="profileOwner.profile.is_company">
                          نام شرکت :
                          <span
                            v-text="profileOwner.profile.company_name"
                          ></span>
                        </p>
                      </div>

                      <div class="col-xs-6">
                        <p v-if="profileOwner.profile.is_company">
                          شماره ثبت :
                          <span
                            v-text="profileOwner.profile.company_register_code"
                          ></span>
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="sub-header hidden-sm hidden-md hidden-lg col-xs-12">
            <div class="col-xs-6" :class="{ active: profileDescription }">
              <a @click="showProfileOwnerDescription($event)" href>
                <div class="inside-links">
                  <i class="fa fa-edit" aria-hidden="true"></i> توضیحات من
                </div>
              </a>
            </div>

            <div class="col-xs-6" :class="{ active: !profileDescription }">
              <a @click="showProfileOwnerProducts($event)" href="#">
                <div class="inside-links">
                  <i class="buskool-icon" aria-hidden="true">
                    <img :src="incobaicon" />
                  </i>
                  محصولات من
                </div>
              </a>
            </div>
          </div>

          <div class="sub-header hidden-xs col-xs-12">
            <ul class="list-inline">
              <li class="list-item" :class="{ active: !profileDescription }">
                <a @click="showProfileOwnerProducts($event)" href>محصولات من</a>
              </li>

              <li class="list-item" :class="{ active: profileDescription }">
                <a @click="showProfileOwnerDescription($event)" href
                  >توضیحات من</a
                >
              </li>
            </ul>
          </div>
          <div class="contents col-xs-12" v-if="profileDescription === true">
            <div class="des col-xs-12">
              <p class="title-content">توضیحات</p>

              <div
                v-if="profileOwner.profile.description"
                class="description"
                v-text="profileOwner.profile.description"
              ></div>
              <div v-else>
                <span
                  class="content-default-width placeholder-content margin-15 h-20"
                ></span>
                <span
                  class="content-half-width placeholder-content margin-0-15 h-20"
                ></span>
                <span
                  class="content-full-width placeholder-content margin-15"
                ></span>
              </div>
            </div>

            <div class="cerificates col-xs-12">
              <p class="title-content">عکس های مرتبط :</p>

              <div v-if="profileOwner.relateds[0]">
                <PopupImageCertificate
                  v-for="photo in profileOwner.relateds"
                  :key="photo.id"
                  class="ceteficate-image col-xs-6 hidden-sm hidden-md hidden-lg"
                  :base="str + '/'"
                  :img="photo"
                />

                <div class="owl-carousel hidden-xs">
                  <OwlCarousel
                    @click="
                      registerComponentStatistics(
                        'profileView',
                        'RelatedView',
                        'click on related photos'
                      )
                    "
                    v-for="photo in profileOwner.relateds"
                    :key="photo.id"
                    :base="str + '/'"
                    :img="photo"
                  />
                </div>
              </div>

              <div class="wrapper_no_pic" v-else>
                <div class="content_no_pic">
                  <i class="far fa-images"></i>
                </div>

                <div class="text_no_pic">
                  <p>تصویری ثبت نشده است</p>
                </div>
              </div>
            </div>

            <div class="cerificates col-xs-12">
              <p class="title-content">مدارک من :</p>

              <div v-if="profileOwner.certificates[0]">
                <article
                  v-for="photo in profileOwner.certificates"
                  class="ceteficate-image col-xs-6 hidden-sm hidden-md hidden-lg"
                >
                  <a :href="str + '/' + photo">
                    <img :src="str + '/' + photo" />
                  </a>
                </article>

                <div class="owl-carousel hidden-xs">
                  <OwlCarousel
                    @click="
                      registerComponentStatistics(
                        'profileView',
                        'CertificateView',
                        'click on certificate photos'
                      )
                    "
                    v-for="photo in profileOwner.certificates"
                    :base="str + '/'"
                    :key="photo.id"
                    :img="photo"
                  />
                </div>
              </div>

              <div class="wrapper_no_pic" v-else>
                <div class="content_no_pic">
                  <i class="far fa-images"></i>
                </div>
                <div class="text_no_pic">
                  <p>مدارکی ثبت نشده است</p>
                </div>
              </div>
            </div>
          </div>

          <div class="contents" v-else>
            <div class="row">
              <!-- <div v-for="(product,productIndex) in products" :key="productIndex"
                                 class="col-xs-12 pull-right">
                                <ProductArticle
                                        :product="product"
                                        :loading_img="loading_img"
                                        :defultimg="defultimg"
                                        :str="str"
                                        :loading="loading"
                                        :currentUser="currentUser"
                                />
              </div>-->

              <div
                class="col-xs-12 pull-right"
                :key="productIndex"
                v-for="(product, productIndex) in products"
              >
                <ProductArticle
                  :productIndex="productIndex"
                  v-if="products.length >= productIndex"
                  :key="product.main.id"
                  :product="product"
                  :loading_img="loading_img"
                  :defultimg="defultimg"
                  :str="str"
                  :loading="loading"
                  :currentUser="currentUser"
                />
              </div>
            </div>

            <div class="col-xs-12" v-if="products.length === 0 && !loading">
              <div class="col-xs-12" v-if="products.length === 0 && !loading">
                <div class="wrapper_no_pro">
                  <div class="content_no_pic">
                    <i class="fa fa-list-alt"></i>
                  </div>
                  <div class="text_no_pic">
                    <p>محصولی ثبت نشده است</p>
                  </div>
                </div>
              </div>
            </div>

            <div class="loading_images col-xs-12" v-show="loading">
              <img :src="loading_img" style="width: 200px; height: 200px;" />
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>
</template>

<script>
import ProductArticle from "./product_components/product_article";
import { eventBus } from "../../../router/router";

var visible = false;
var PopupImage = {
  data: function () {
    return {
      imgSrcs: "",
    };
  },
  props: ["img", "base"],
  template:
    '<div class="image-wrapper">' +
    '<a   :href="base + img">' +
    '<img :src="base + img">' +
    "</a>" +
    "</div>",
  mounted: function () {
    $(this.$el)
      .parent()
      .magnificPopup({
        delegate: "a",
        type: "image",
        mainClass: "mfp-img-mobile",
        gallery: {
          enabled: true,
          navigateByImgClick: true,
          preload: [0, 1], // Will preload 0 - before current, and 1 after the current image
        },
      });
  },
};
var PopupImageCertificate = {
  props: ["img", "base"],
  template: '<a   :href="base + img">' + '<img :src="base + img">' + "</a>",
  mounted: function () {
    $(".cerificates > div").each(function () {
      // the containers for all your galleries
      $(this).magnificPopup({
        delegate: "a", // the selector for gallery item
        type: "image",
        gallery: {
          enabled: true,
        },
      });
    });
  },
};
var OwlCarouselLists = {
  data: function () {
    return {
      imgSrcs: "",
    };
  },
  props: ["img", "base"],
  template:
    '<div class="image-wrapper">' +
    '<a  :href="base + img">' +
    '<img :src="base + img">' +
    "</a>" +
    "</div>",
  mounted: function () {
    $(".owl-carousel").owlCarousel({
      loop: false,
      items: 1,
      margin: 10,
      nav: false,
      dots: true,
    });
    $(this.$el)
      .parent()
      .parent()
      .parent()
      .magnificPopup({
        delegate: "a",
        type: "image",
        gallery: {
          enabled: true,
          navigateByImgClick: true,
          preload: [0, 1], // Will preload 0 - before current, and 1 after the current image
        },
      });
  },
};
var OwlCarousel = {
  data: function () {
    return {
      imgSrcs: "",
    };
  },
  props: ["img", "base"],
  template:
    '<div class="image-wrapper">' +
    '<a  :href="base + img">' +
    '<img :src="base + img">' +
    "</a>" +
    "</div>",
  mounted: function () {
    $(".owl-carousel").owlCarousel({
      loop: false,
      margin: 10,
      nav: true,
      dots: false,
    });
    $(this.$el)
      .parent()
      .parent()
      .parent()
      .magnificPopup({
        delegate: "a",
        type: "image",
        gallery: {
          enabled: true,
          navigateByImgClick: true,
          preload: [0, 1], // Will preload 0 - before current, and 1 after the current image
        },
      });
  },
};

export default {
  components: {
    OwlCarousel,
    OwlCarouselLists,
    PopupImage,
    PopupImageCertificate,
    ProductArticle,
  },
  props: ["defultimg", "incobaicon", "str", "loading_img"],
  data: function () {
    return {
      products: {
        main: "",
        user_info: "",
        profile_info: {
          profile_photo: "",
        },
        photos: [],
      },
      currentUser: {
        profile: "",
        user_info: "",
      },
      profileOwner: {
        profile: "",
        user_info: "",
        certificates: "",
        relateds: "",
        activity_domain: "",
        is_buyer: "",
      },
      profileDescription: true,
      noProductMsgSignal: false,
      loading: false,
      isMyProfile: true,
      popUpMsg: "",
      submiting: "",
      copyLinkText: "",
      copyLinkClass: "",
      profileOwnerStatistics: {
        transaction_count: "",
        product_count: "",
        buyAd_count: "",
      },
      getUserName: this.$route.params.user_name,
      jsonLDObject: "",
    };
  },
  methods: {
    stopLoader: function () {
      eventBus.$emit("isLoading", false);
    },
    collapseDropDown: function () {
      $(".profile-list").fadeIn("slow", function () {
        visible = true;
      });
    },
    collapseDropDownList: function () {
      $(".icon-header-list").fadeIn("slow", function () {
        visible = true;
      });
    },
    documentClick(e) {
      if (visible) {
        $(".profile-list").fadeOut("slow");
        $(".icon-header-list").fadeOut("slow");
        visible = false;
      }
    },
    init: function () {
      var self = this;

      if (this.isDeviceMobile()) {
        this.copyLinkText = " اشتراک در واتساپ";
        this.copyLinkClass = "fab fa-whatsapp fa-2x";
      } else {
        this.copyLinkText = "کپی آدرس";
        this.copyLinkClass = "fa fa-copy";
      }

      axios
        .post("/get_user_statistics_by_user_name", {
          user_name: this.$route.params.user_name,
        })
        .then(function (response) {
          self.profileOwnerStatistics = response.data.statistics;
        })
        .catch(function (err) {
          //
        });
      axios
        .post("/user/profile_info")
        .then((response) => (this.currentUser = response.data));

      axios
        .post("/load_profile_by_user_name", {
          user_name: this.$route.params.user_name,
        })
        .then(function (response) {
          self.profileOwner = response.data;
          self.jsonLDObject = self.createJsonLDObject(self.profileOwner);
        })
        .catch(function (err) {
          if (err.response.status === 404) {
            window.location.href = "/404";
          }
        });
    },
    showProfileOwnerProducts: function (e) {
      this.registerComponentStatistics(
        "profileView",
        "showUserProducts",
        "click on show products"
      );

      e.preventDefault();
      this.profileDescription = false;

      this.loading = true;

      var self = this;
      axios
        .post("/get_product_list_by_user_name", {
          user_name: this.$route.params.user_name,
        })
        .then(function (response) {
          self.products = response.data.products;

          self.loading = false;
        });
    },
    showProfileOwnerDescription: function (e) {
      this.registerComponentStatistics(
        "profileView",
        "profileDescription",
        "click on profile description"
      );

      e.preventDefault();
      this.profileDescription = true;
      this.profileOwner.profile = "";

      axios
        .post("/load_profile_by_user_name", {
          user_name: this.$route.params.user_name,
        })
        .then((response) => (this.profileOwner = response.data))
        .catch(function (err) {
          if (err.response.status == 404) {
            window.location.href = "/404";
          }
        });
    },
    refreshProduct: function (productId) {
      this.registerComponentStatistics(
        "profileView",
        "RefreshProduct",
        "refresh product"
      );

      var self = this;

      axios
        .post("/refresh_my_product_by_id", {
          product_id: productId,
        })
        .then(function (response) {
          if (response.data.status === true) {
            self.popUpMsg =
              "محصول شما بروز رسانی شد و در صدر لیست محصولات قرار گرفت.";
            eventBus.$emit("submitSuccess", self.popUpMsg);
            $("#custom-main-modal").modal("show");
          } else {
            self.popUpMsg =
              "هم اکنون قادر به انجام عملیات نیستیم.دوباره تلاش کنید.";
            eventBus.$emit("submitSuccess", self.popUpMsg);
            $("#custom-main-modal").modal("show");
          }
        })
        .catch(function (err) {
          self.popUpMsg =
            "هم اکنون قادر به انجام عملیات نیستیم.دوباره تلاش کنید.";
          eventBus.$emit("submitSuccess", self.popUpMsg);
          $("#custom-main-modal").modal("show");
        });
    },
    copyProfileLinkToClipBoard: function () {
      this.registerComponentStatistics(
        "profileView",
        "CopyProfileLink",
        "click on copy profile link"
      );

      if (this.isDeviceMobile()) {
        var linkElement = document.createElement("a");
        var Message =
          "https://buskool.com/profile/" +
          this.profileOwner.user_info.user_name;
        var messageToWhatsApp = encodeURIComponent(Message);
        var url = "whatsapp://send?text=" + messageToWhatsApp;
        linkElement.setAttribute("href", url);
        linkElement.setAttribute("data-action", "share/whatsapp/share");
        document.body.appendChild(linkElement);

        linkElement.click();

        document.body.removeChild(linkElement);
      } else {
        var input = document.createElement("input");
        input.setAttribute(
          "value",
          "https://buskool.com/profile/" + this.profileOwner.user_info.user_name
        );
        document.body.appendChild(input);
        input.select();
        var result = document.execCommand("copy");
        document.body.removeChild(input);
        if (result) {
          this.popUpMsg = "آدرس پروفایل کاربر کپی شد.";
          eventBus.$emit("submitSuccess", this.popUpMsg);
          $("#custom-main-modal").modal("show");
        }
      }
    },
    isDeviceMobile: function () {
      if (
        navigator.userAgent.match(/Android/i) ||
        navigator.userAgent.match(/webOS/i) ||
        navigator.userAgent.match(/iPhone/i) ||
        navigator.userAgent.match(/iPad/i) ||
        navigator.userAgent.match(/iPod/i) ||
        navigator.userAgent.match(/BlackBerry/i) ||
        navigator.userAgent.match(/Windows Phone/i)
      ) {
        return true;
      } else {
        return false;
      }
    },
    openChat: function () {
      this.registerComponentStatistics(
        "profileView",
        "openChat",
        "click on open chatBox"
      );

      var contact = {
        contact_id: this.profileOwner.user_info.id,
        first_name: this.profileOwner.user_info.first_name,
        last_name: this.profileOwner.user_info.last_name,
        profile_photo: this.profileOwner.profile.profile_photo,
        user_name: this.profileOwner.user_info.user_name,
      };
      var self = this;

      if (this.currentUser.user_info) {
        eventBus.$emit("ChatInfo", contact);
      } else {
        window.localStorage.setItem("contact", JSON.stringify(contact));
        window.localStorage.setItem("pathname", window.location.pathname);

        eventBus.$emit('modal','sendMsg');
      }
    },
    createJsonLDObject: function (profileOwner) {
      var fullName =
        profileOwner.user_info.first_name +
        " " +
        profileOwner.user_info.last_name;
      var address =
        profileOwner.user_info.province + " - " + profileOwner.user_info.city;

      var images = [];
      profileOwner.certificates.forEach(function (photo) {
        images.push("https://buskool.com/storage/" + photo);
      });
      profileOwner.relateds.forEach(function (photo) {
        images.push("https://buskool.com/storage/" + photo);
      });

      if (profileOwner.profile.profile_photo) {
        images.push(
          "https://buskool.com/storage/" + profileOwner.profile.profile_photo
        );
      }

      if (profileOwner.user_info.is_seller) {
        var jobTitle = "فروشنده ی " + " " + profileOwner.activity_domain;
      } else {
        var jobTitle = "خریدار " + " " + profileOwner.activity_domain;
      }

      var gender = profileOwner.user_info.sex == "آقا" ? "male" : "female";

      var jsondl = {
        "@context": "https://schema.org",
        "@type": "Person",
        address: {
          "@type": "PostalAddress",
          addressLocality: address,
        },
        image: images,
        jobTitle: jobTitle,
        name: fullName,
        gender: gender,
        nationality: "Iranian",
        url:
          "http://www.buskool.com/profile/" + profileOwner.user_info.user_name,
      };

      return jsondl;
    },
    registerComponentStatistics: function (
      categoryName,
      actionName,
      labelName
    ) {
      gtag("event", actionName, {
        event_category: categoryName,
        event_label: labelName,
      });
    },
    activeReviewModal: function () {
      var userImage = "";

      if (this.profileOwner.profile.profile_photo) {
        userImage = this.str + "/" + this.profileOwner.profile.profile_photo;
      } else {
        userImage = this.defultImg;
      }

      var selectedUserData = {
        name:
          this.profileOwner.user_info.first_name +
          " " +
          this.profileOwner.user_info.last_name,
        img: userImage,
      };
      eventBus.$emit("reviewUserData", selectedUserData);
    },
  },
  mounted() {
    this.init();
    this.$nextTick(this.stopLoader());
  },
  updated: function () {
    this.$nextTick(this.stopLoader());
  },
  created() {
    gtag("config", "UA-129398000-1", { page_path: "/profile" });

    document.addEventListener("click", this.documentClick);
  },
  metaInfo() {
    let fullName =
      this.profileOwner.user_info.first_name +
      " " +
      this.profileOwner.user_info.last_name;

    let url =
      window.location.host +
      "/profile/" +
      this.profileOwner.user_info.user_name;
    let profilePhoto = "";

    if (this.profileOwner.profile.profile_photo) {
      profilePhoto = this.str + "/" + this.profileOwner.profile.profile_photo;
    } else {
      profilePhoto = this.defultimg;
    }

    let indexingStatus = "";
    if(!!this.profileOwner.profile.description && this.profileOwner.profile.description.length > 500){
      indexingStatus = 'index';
    }
    else{
      indexingStatus = 'noindex';
    }

    return {
      title: fullName,
      titleTemplate: "%s | باسکول",
      meta: [
        {
          name: "description",
          content:
            " محصولات کشاورزی و تصاویر محصولات من را در این صفحه مشاهده کنید",
        },
        {
          name: "robots",
          content : indexingStatus
        },
        {
          property: "og:type",
          content: "website",
        },
        {
          property: "og:image:height",
          content: "256",
        },
        {
          property: "og:image:width",
          content: "256",
        },
        {
          property: "og:image:type",
          content: "image/jpeg",
        },
        {
          property: "og:description",
          content: "صفحه ی پروفایل کاربران باسکول",
        },
        {
          property: "og:site_name",
          content: "باسکول",
        },
        {
          property: "og:url",
          content: url,
        },
        {
          property: "og:title",
          content: fullName,
        },
        {
          property: "og:image",
          content: profilePhoto,
        },
      ],
      link: [{ rel: "canonical", href: url }],
    };
  },
};
</script>
